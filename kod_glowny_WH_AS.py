import arcpy
from arcpy.sa import *

def Model(): 
    # Wyniki nie mogą się nadpisywać
    arcpy.env.overwriteOutput = False

    arcpy.CheckOutExtension("spatial")
    arcpy.CheckOutExtension("3D")
    arcpy.CheckOutExtension("ImageAnalyst")

    arcpy.ImportToolbox(r"c:\program files\arcgis\pro\Resources\ArcToolbox\toolboxes\Data Management Tools.tbx")
    temp = r"C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\temp"

    # Zaczytanie danych ze ścieżek 
    with arcpy.EnvManager(scratchWorkspace=f"{temp}", workspace=f"{temp}"):
        linie_energetyczne = "PL.PZGiK.336.BDOT10k.2216__OT_SULN_L"
        budynki = "PL.PZGiK.336.BDOT10k.2216__OT_BUBD_A"
        powiat_sztumski_granica_shp = r"C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\dane_BDOT10k_wybrane\\powiat_sztumski_granica.shp"
        rasterWynikowy_tif = arcpy.Raster("rasterWynikowy.tif")
        parki_krajobrazowe = "PL.PZGiK.336.BDOT10k.2216__OT_TCPK_A"
        obszary_Natura_2000 = "PL.PZGiK.336.BDOT10k.2216__OT_TCON_A"
        rezerwaty = "PL.PZGiK.336.BDOT10k.2216__OT_TCRZ_A"
        kanal = "PL.PZGiK.336.BDOT10k.2216__OT_SWKN_L"
        wody_powierzchniowe = "PL.PZGiK.336.BDOT10k.2216__OT_PTWP_A"
        roslinnosc_trawiasta_i_rolna = "PL.PZGiK.336.BDOT10k.2216__OT_PTTR_A"
        obszary_niezabudowane = "PL.PZGiK.336.BDOT10k.2216__OT_PTNZ_A"

        # Select Layer By Attribute - wybór linii najwyższego napięcia
        PL_PZGiK_336_BDOT10k_2216_OT_SULN_L, Count = arcpy.management.SelectLayerByAttribute(in_layer_or_view=linie_energetyczne, where_clause="RODZAJ = 'linia elektroenergetyczna najwyższego napięcia'")

        # Select Layer By Attribute - wybór budynków, które nie są mieszkalne 
        PL_PZGiK_336_BDOT10k_2216_OT_BUBD_A_4_, Count_4_ = arcpy.management.SelectLayerByAttribute(in_layer_or_view=budynki, where_clause="FOBUD <> 'budynki mieszkalne'")

        # Copy Features - kopiowanie wybranych budynków
        budynki_pozostale_shp = fr"{temp}\budynki_pozostale.shp"
        arcpy.management.CopyFeatures(in_features=PL_PZGiK_336_BDOT10k_2216_OT_BUBD_A_4_, out_feature_class=budynki_pozostale_shp)

        # Buffer - utworzenie buforu dla skopiowanych budynków budynków
        bud_poz_buf = fr"{temp}\bud_poz_buf"
        arcpy.analysis.Buffer(in_features=budynki_pozostale_shp, out_feature_class=bud_poz_buf, buffer_distance_or_field="700 Meters")

        # Select Layer By Attribute - wybór budynków mieszkalnych
        PL_PZGiK_336_BDOT10k_2216_OT_BUBD_A_2_, Count_3_ = arcpy.management.SelectLayerByAttribute(in_layer_or_view=budynki, where_clause="FOBUD = 'budynki mieszkalne'")

        # Copy Features - kopiowanie wybranych budynków
        zbudynki_mieszkalne_shp = fr"{temp}\zbudynki_mieszkalne.shp"
        arcpy.management.CopyFeatures(in_features=PL_PZGiK_336_BDOT10k_2216_OT_BUBD_A_2_, out_feature_class=zbudynki_mieszkalne_shp)

        # Buffer - utworzenie buforu dla skopiowanych budynków 
        budynki_buf_shp = fr"{temp}\budynki_buf.shp"
        arcpy.analysis.Buffer(in_features=zbudynki_mieszkalne_shp, out_feature_class=budynki_buf_shp, buffer_distance_or_field="950 Meters")

        # Merge - połączenie dwóch warstw budynków po utworzeniu buforu
        bud_buf_merge_shp = fr"{temp}\bud_buf_merge.shp"
        arcpy.management.Merge(inputs=[bud_poz_buf, budynki_buf_shp], output=bud_buf_merge_shp, field_mappings="TERYT \"TERYT\" true true false 4 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\bud_poz_buf.shp,TERYT,0,3,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\budynki_buf.shp,TERYT,0,3;LOKALNYID \"LOKALNYID\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\bud_poz_buf.shp,LOKALNYID,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\budynki_buf.shp,LOKALNYID,0,253;PRZES_NAZW \"PRZES_NAZW\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\bud_poz_buf.shp,PRZES_NAZW,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\budynki_buf.shp,PRZES_NAZW,0,253;WERSJA \"WERSJA\" true true false 21 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\bud_poz_buf.shp,WERSJA,0,20,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\budynki_buf.shp,WERSJA,0,20;POCZ_WERSJ \"POCZ_WERSJ\" true true false 21 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\bud_poz_buf.shp,POCZ_WERSJ,0,20,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\budynki_buf.shp,POCZ_WERSJ,0,20;OZNA_ZMIAN \"OZNA_ZMIAN\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\bud_poz_buf.shp,OZNA_ZMIAN,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\budynki_buf.shp,OZNA_ZMIAN,0,253;ZRO_DANYCH \"ZRO_DANYCH\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\bud_poz_buf.shp,ZRO_DANYCH,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\budynki_buf.shp,ZRO_DANYCH,0,253;KAT_ISTNIE \"KAT_ISTNIE\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\bud_poz_buf.shp,KAT_ISTNIE,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\budynki_buf.shp,KAT_ISTNIE,0,253;UWAGI \"UWAGI\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\bud_poz_buf.shp,UWAGI,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\budynki_buf.shp,UWAGI,0,253;INFO_DODAT \"INFO_DODAT\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\bud_poz_buf.shp,INFO_DODAT,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\budynki_buf.shp,INFO_DODAT,0,253;KOD10K \"KOD10K\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\bud_poz_buf.shp,KOD10K,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\budynki_buf.shp,KOD10K,0,253;SKROT_KART \"SKROT_KART\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\bud_poz_buf.shp,SKROT_KART,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\budynki_buf.shp,SKROT_KART,0,253;KODKST \"KODKST\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\bud_poz_buf.shp,KODKST,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\budynki_buf.shp,KODKST,0,253;FOBUD \"FOBUD\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\bud_poz_buf.shp,FOBUD,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\budynki_buf.shp,FOBUD,0,253;FSBUD \"FSBUD\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\bud_poz_buf.shp,FSBUD,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\budynki_buf.shp,FSBUD,0,253;PFBUD \"PFBUD\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\bud_poz_buf.shp,PFBUD,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\budynki_buf.shp,PFBUD,0,253;LICZ_KONDY \"LICZ_KONDY\" true true false 22 Double 0 22,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\bud_poz_buf.shp,LICZ_KONDY,-1,-1,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\budynki_buf.shp,LICZ_KONDY,-1,-1;NAZWA \"NAZWA\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\bud_poz_buf.shp,NAZWA,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\budynki_buf.shp,NAZWA,0,253;BUFF_DIST \"BUFF_DIST\" true true false 0 Double 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\bud_poz_buf.shp,BUFF_DIST,-1,-1,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\budynki_buf.shp,BUFF_DIST,-1,-1;ORIG_FID \"ORIG_FID\" true true false 0 Long 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\bud_poz_buf.shp,ORIG_FID,-1,-1,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\projekt_model\\.\\temp\\budynki_buf.shp,ORIG_FID,-1,-1")

        # Clip - przycięcie połączonej warstwy budynków do granicy powiatu 
        zabudowa_buf_Clip_shp = fr"{temp}\zabudowa_buf_Clip.shp"
        arcpy.analysis.Clip(in_features=bud_buf_merge_shp, clip_features=powiat_sztumski_granica_shp, out_feature_class=zabudowa_buf_Clip_shp)

        # Dissolve - Połączenie elementów warstwy w jeden obiekt
        zabudowa_diss_shp = fr"{temp}\zabudowa_diss.shp"
        arcpy.management.Dissolve(in_features=zabudowa_buf_Clip_shp, out_feature_class=zabudowa_diss_shp)

        # Union - wypełnienie miejsc gdzie bufor nie sięgnął 
        zabudowa_diss_union_shp = fr"{temp}\zabudowa_diss_union.shp"
        arcpy.analysis.Union(in_features=[[zabudowa_diss_shp, ""], [powiat_sztumski_granica_shp, ""]], out_feature_class=zabudowa_diss_union_shp)

        # Polygon to Raster - zamiana warstwy wektorowej na rastrową
        zabudowa_raster_tif = fr"{temp}\zabudowa_raster.tif"
        arcpy.conversion.PolygonToRaster(in_features=zabudowa_diss_union_shp, value_field="FID", out_rasterdataset=zabudowa_raster_tif)

        # Reclassify - reklasyfikacja warstwy rastrowej budynków tereny spełniające nasz warunek wartość 1 nie spełniające warunku wartość 0 
        zabudow_reclass_tif = fr"{temp}\zabudow_reclass.tif"
        arcpy.ddd.Reclassify(in_raster=zabudowa_raster_tif, reclass_field="VALUE", remap="0 1;1 0", out_raster=zabudow_reclass_tif)
        zabudow_reclass_tif = arcpy.Raster(zabudow_reclass_tif)

        # Extract by Mask - przycięcie połączonego rastra do granic powiatu
        raster_mask_tif = fr"{temp}\raster_mask.tif"
        Extract_by_Mask = raster_mask_tif
        raster_mask_tif = arcpy.sa.ExtractByMask(rasterWynikowy_tif, powiat_sztumski_granica_shp, "INSIDE", "490667.148980395 656819.393946399 538227.328647945 684808.09533769 PROJCS[\"ETRF2000-PL_CS92\".GEOGCS[\"ETRF2000-PL\".DATUM[\"ETRF2000_Poland\".SPHEROID[\"GRS_1980\".6378137.0.298.257222101]].PRIMEM[\"Greenwich\".0.0].UNIT[\"Degree\".0.0174532925199433]].PROJECTION[\"Transverse_Mercator\"].PARAMETER[\"False_Easting\".500000.0].PARAMETER[\"False_Northing\".-5300000.0].PARAMETER[\"Central_Meridian\".19.0].PARAMETER[\"Scale_Factor\".0.9993].PARAMETER[\"Latitude_Of_Origin\".0.0].UNIT[\"Meter\".1.0]]")
        raster_mask_tif.save(Extract_by_Mask)

        # Aspect - na przyciętym rastrze wysokościowym wykonano ekspozycje
        raster_aspect_tif = fr"{temp}\raster_aspect.tif"
        Aspect = raster_aspect_tif
        raster_aspect_tif = arcpy.sa.Aspect(raster_mask_tif, "PLANAR", "METER", "GEODESIC_AZIMUTHS", "GPU_THEN_CPU")
        raster_aspect_tif.save(Aspect)

        # Reclassify - raster z ekspozycją zreklasyfikowano i wybrano interesujące nas tereny 
        aspect_reclass_tif = fr"{temp}\aspect_reclass.tif"
        Reclassify_2_ = aspect_reclass_tif
        aspect_reclass_tif = arcpy.sa.Reclassify(raster_aspect_tif, "VALUE", "-1 202,500000 0;202,500000 337,500000 1;337,500000 360 0", "DATA")
        aspect_reclass_tif.save(Reclassify_2_)

        # Buffer - utworzenie buforu do warstwy rezerwatów
        rezerwaty_buf_shp = fr"{temp}\rezerwaty_buf.shp"
        arcpy.analysis.Buffer(in_features=rezerwaty, out_feature_class=rezerwaty_buf_shp, buffer_distance_or_field="500 Meters")

        # Merge - połączenie terenów chronionych w jedną warstwę 
        obszaryChronione_merge_shp = fr"{temp}\obszaryChronione_merge.shp"
        arcpy.management.Merge(inputs=[parki_krajobrazowe, obszary_Natura_2000, rezerwaty_buf_shp], output=obszaryChronione_merge_shp, field_mappings="TERYT \"TERYT\" true true false 4 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\natura2000.shp,TERYT,0,3,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\parkKrajobrazowy.shp,TERYT,0,3,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\rezerwat.shp,TERYT,0,3;LOKALNYID \"LOKALNYID\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\natura2000.shp,LOKALNYID,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\parkKrajobrazowy.shp,LOKALNYID,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\rezerwat.shp,LOKALNYID,0,253;PRZES_NAZW \"PRZES_NAZW\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\natura2000.shp,PRZES_NAZW,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\parkKrajobrazowy.shp,PRZES_NAZW,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\rezerwat.shp,PRZES_NAZW,0,253;WERSJA \"WERSJA\" true true false 21 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\natura2000.shp,WERSJA,0,20,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\parkKrajobrazowy.shp,WERSJA,0,20,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\rezerwat.shp,WERSJA,0,20;POCZ_WERSJ \"POCZ_WERSJ\" true true false 21 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\natura2000.shp,POCZ_WERSJ,0,20,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\parkKrajobrazowy.shp,POCZ_WERSJ,0,20,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\rezerwat.shp,POCZ_WERSJ,0,20;OZNA_ZMIAN \"OZNA_ZMIAN\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\natura2000.shp,OZNA_ZMIAN,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\parkKrajobrazowy.shp,OZNA_ZMIAN,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\rezerwat.shp,OZNA_ZMIAN,0,253;ZRO_DANYCH \"ZRO_DANYCH\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\natura2000.shp,ZRO_DANYCH,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\parkKrajobrazowy.shp,ZRO_DANYCH,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\rezerwat.shp,ZRO_DANYCH,0,253;KAT_ISTNIE \"KAT_ISTNIE\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\natura2000.shp,KAT_ISTNIE,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\parkKrajobrazowy.shp,KAT_ISTNIE,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\rezerwat.shp,KAT_ISTNIE,0,253;UWAGI \"UWAGI\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\natura2000.shp,UWAGI,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\parkKrajobrazowy.shp,UWAGI,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\rezerwat.shp,UWAGI,0,253;INFO_DODAT \"INFO_DODAT\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\natura2000.shp,INFO_DODAT,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\parkKrajobrazowy.shp,INFO_DODAT,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\rezerwat.shp,INFO_DODAT,0,253;KOD10K \"KOD10K\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\natura2000.shp,KOD10K,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\parkKrajobrazowy.shp,KOD10K,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\rezerwat.shp,KOD10K,0,253;SKROT_KART \"SKROT_KART\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\natura2000.shp,SKROT_KART,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\parkKrajobrazowy.shp,SKROT_KART,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\rezerwat.shp,SKROT_KART,0,253;NR_CRFOP \"NR_CRFOP\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\natura2000.shp,NR_CRFOP,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\parkKrajobrazowy.shp,NR_CRFOP,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\rezerwat.shp,NR_CRFOP,0,253;NAZWA \"NAZWA\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\natura2000.shp,NAZWA,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\parkKrajobrazowy.shp,NAZWA,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\rezerwat.shp,NAZWA,0,253;NATURA2000 \"NATURA2000\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\natura2000.shp,NATURA2000,0,253")

        # Clip - przycięcie terenów chronionych do granic powiatu
        obszaryChronione_Clip_shp = fr"{temp}\obszaryChronione_Clip.shp"
        arcpy.analysis.Clip(in_features=obszaryChronione_merge_shp, clip_features=powiat_sztumski_granica_shp, out_feature_class=obszaryChronione_Clip_shp)

        # Dissolve - połączenie terenów chronionych w jeden obiekt
        obszaryChronione_Diss = fr"{temp}\obszaryChronione_Diss"
        arcpy.management.Dissolve(in_features=obszaryChronione_Clip_shp, out_feature_class=obszaryChronione_Diss)

        # Union - wypełnianie brakującego terenu do granic powiatu
        obszaryChronione_Union_shp = fr"{temp}\obszaryChronione_Union.shp"
        arcpy.analysis.Union(in_features=[[obszaryChronione_Diss, ""], [powiat_sztumski_granica_shp, ""]], out_feature_class=obszaryChronione_Union_shp)

        # Polygon to Raster - konwersja warstwy wektorowej do rastrowej
        obszaryChronione_raster_tif = fr"{temp}\obszaryChronione_raster.tif"
        arcpy.conversion.PolygonToRaster(in_features=obszaryChronione_Union_shp, value_field="FID_obszar", out_rasterdataset=obszaryChronione_raster_tif)

        # Reclassify - reklasyfikacja powstałej warstwy 
        obszaryChronione_reclass_tif = fr"{temp}\obszaryChronione_reclass.tif"
        Reclassify_4_ = obszaryChronione_reclass_tif
        obszaryChronione_reclass_tif = arcpy.sa.Reclassify(obszaryChronione_raster_tif, "VALUE", "-1 1;0 0", "DATA")
        obszaryChronione_reclass_tif.save(Reclassify_4_)

        # Buffer - bufor kanałów 
        kanaly_buf_shp = fr"{temp}\kanaly_buf.shp"
        arcpy.analysis.Buffer(in_features=kanal, out_feature_class=kanaly_buf_shp, buffer_distance_or_field="200 Meters")

        # Buffer - bufor wód powierzchniowych 
        wodyPowierzchniowe_buf_shp = fr"{temp}\wodyPowierzchniowe_buf.shp"
        arcpy.analysis.Buffer(in_features=wody_powierzchniowe, out_feature_class=wodyPowierzchniowe_buf_shp, buffer_distance_or_field="200 Meters")

        # Merge - połaczenie sieci wodnej w jedną warstwę
        wody_Merge_shp = fr"{temp}\wody_Merge.shp"
        arcpy.management.Merge(inputs=[kanaly_buf_shp, wodyPowierzchniowe_buf_shp], output=wody_Merge_shp, field_mappings="TERYT \"TERYT\" true true false 4 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\kanaly_buf.shp,TERYT,0,3,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\wodyPowierzchniowe_buf.shp,TERYT,0,3;LOKALNYID \"LOKALNYID\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\kanaly_buf.shp,LOKALNYID,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\wodyPowierzchniowe_buf.shp,LOKALNYID,0,253;PRZES_NAZW \"PRZES_NAZW\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\kanaly_buf.shp,PRZES_NAZW,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\wodyPowierzchniowe_buf.shp,PRZES_NAZW,0,253;WERSJA \"WERSJA\" true true false 21 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\kanaly_buf.shp,WERSJA,0,20,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\wodyPowierzchniowe_buf.shp,WERSJA,0,20;POCZ_WERSJ \"POCZ_WERSJ\" true true false 21 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\kanaly_buf.shp,POCZ_WERSJ,0,20,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\wodyPowierzchniowe_buf.shp,POCZ_WERSJ,0,20;OZNA_ZMIAN \"OZNA_ZMIAN\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\kanaly_buf.shp,OZNA_ZMIAN,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\wodyPowierzchniowe_buf.shp,OZNA_ZMIAN,0,253;ZRO_DANYCH \"ZRO_DANYCH\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\kanaly_buf.shp,ZRO_DANYCH,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\wodyPowierzchniowe_buf.shp,ZRO_DANYCH,0,253;KAT_ISTNIE \"KAT_ISTNIE\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\kanaly_buf.shp,KAT_ISTNIE,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\wodyPowierzchniowe_buf.shp,KAT_ISTNIE,0,253;UWAGI \"UWAGI\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\kanaly_buf.shp,UWAGI,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\wodyPowierzchniowe_buf.shp,UWAGI,0,253;INFO_DODAT \"INFO_DODAT\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\kanaly_buf.shp,INFO_DODAT,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\wodyPowierzchniowe_buf.shp,INFO_DODAT,0,253;KOD10K \"KOD10K\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\kanaly_buf.shp,KOD10K,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\wodyPowierzchniowe_buf.shp,KOD10K,0,253;SKROT_KART \"SKROT_KART\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\kanaly_buf.shp,SKROT_KART,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\wodyPowierzchniowe_buf.shp,SKROT_KART,0,253;IDPRNG \"IDPRNG\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\kanaly_buf.shp,IDPRNG,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\wodyPowierzchniowe_buf.shp,IDPRNG,0,253;POLOZENIE \"POLOZENIE\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\kanaly_buf.shp,POLOZENIE,0,253;SZEROKOSC \"SZEROKOSC\" true true false 31 Double 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\kanaly_buf.shp,SZEROKOSC,-1,-1;NAZWA \"NAZWA\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\kanaly_buf.shp,NAZWA,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\wodyPowierzchniowe_buf.shp,NAZWA,0,253;STAT_EKSPL \"STAT_EKSPL\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\kanaly_buf.shp,STAT_EKSPL,0,253;CECHY_GEOM \"CECHY_GEOM\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\kanaly_buf.shp,CECHY_GEOM,0,253;IDMPHP \"IDMPHP\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\kanaly_buf.shp,IDMPHP,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\wodyPowierzchniowe_buf.shp,IDMPHP,0,253;BUFF_DIST \"BUFF_DIST\" true true false 0 Double 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\kanaly_buf.shp,BUFF_DIST,-1,-1,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\wodyPowierzchniowe_buf.shp,BUFF_DIST,-1,-1;ORIG_FID \"ORIG_FID\" true true false 0 Long 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\kanaly_buf.shp,ORIG_FID,-1,-1,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\wodyPowierzchniowe_buf.shp,ORIG_FID,-1,-1;RODZAJ \"RODZAJ\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\wodyPowierzchniowe_buf.shp,RODZAJ,0,253;BDOT500 \"BDOT500\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\temp\\wodyPowierzchniowe_buf.shp,BDOT500,0,253")

        # Clip - przycięcie sieci wodnej do granic powaitu 
        wody_Clip_shp = fr"{temp}\wody_Clip.shp"
        arcpy.analysis.Clip(in_features=wody_Merge_shp, clip_features=powiat_sztumski_granica_shp, out_feature_class=wody_Clip_shp)

        # Dissolve - połączenie sieci wodnej w jeden obiekt
        wody_diss_shp = fr"{temp}\wody_diss.shp"
        arcpy.management.Dissolve(in_features=wody_Clip_shp, out_feature_class=wody_diss_shp)

        # Union - wypełnienien pustych przestrzeni do granic powiatu
        wody_diss_union_shp = fr"{temp}\wody_diss_union.shp"
        arcpy.analysis.Union(in_features=[[wody_diss_shp, ""], [powiat_sztumski_granica_shp, ""]], out_feature_class=wody_diss_union_shp)

        # Polygon to Raster - konwersja warstwy wektorowej na rastrową
        wody_raster_tif = fr"{temp}\wody_raster.tif"
        arcpy.conversion.PolygonToRaster(in_features=wody_diss_union_shp, value_field="FID", out_rasterdataset=wody_raster_tif)

        # Reclassify - reklasyfikacja powstałego rastra
        wody_reclass_tif = fr"{temp}\wody_reclass.tif"
        arcpy.ddd.Reclassify(in_raster=wody_raster_tif, reclass_field="VALUE", remap="0 1;1 0", out_raster=wody_reclass_tif)
        wody_reclass_tif = arcpy.Raster(wody_reclass_tif)

        # Merge - połączenie terenów odpowiednich w jedną warstwę
        obszaryOdpowiednie_merge_shp = fr"{temp}\obszaryOdpowiednie_merge.shp"
        arcpy.management.Merge(inputs=[roslinnosc_trawiasta_i_rolna, obszary_niezabudowane], output=obszaryOdpowiednie_merge_shp, field_mappings="TERYT \"TERYT\" true true false 4 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\niezabudowane.shp,TERYT,0,3,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\trawiasteIRolne.shp,TERYT,0,3,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\nieuzytkowe.shp,TERYT,0,3;LOKALNYID \"LOKALNYID\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\niezabudowane.shp,LOKALNYID,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\trawiasteIRolne.shp,LOKALNYID,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\nieuzytkowe.shp,LOKALNYID,0,253;PRZES_NAZW \"PRZES_NAZW\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\niezabudowane.shp,PRZES_NAZW,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\trawiasteIRolne.shp,PRZES_NAZW,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\nieuzytkowe.shp,PRZES_NAZW,0,253;WERSJA \"WERSJA\" true true false 21 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\niezabudowane.shp,WERSJA,0,20,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\trawiasteIRolne.shp,WERSJA,0,20,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\nieuzytkowe.shp,WERSJA,0,20;POCZ_WERSJ \"POCZ_WERSJ\" true true false 21 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\niezabudowane.shp,POCZ_WERSJ,0,20,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\trawiasteIRolne.shp,POCZ_WERSJ,0,20,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\nieuzytkowe.shp,POCZ_WERSJ,0,20;OZNA_ZMIAN \"OZNA_ZMIAN\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\niezabudowane.shp,OZNA_ZMIAN,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\trawiasteIRolne.shp,OZNA_ZMIAN,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\nieuzytkowe.shp,OZNA_ZMIAN,0,253;ZRO_DANYCH \"ZRO_DANYCH\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\niezabudowane.shp,ZRO_DANYCH,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\trawiasteIRolne.shp,ZRO_DANYCH,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\nieuzytkowe.shp,ZRO_DANYCH,0,253;KAT_ISTNIE \"KAT_ISTNIE\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\niezabudowane.shp,KAT_ISTNIE,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\trawiasteIRolne.shp,KAT_ISTNIE,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\nieuzytkowe.shp,KAT_ISTNIE,0,253;UWAGI \"UWAGI\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\niezabudowane.shp,UWAGI,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\trawiasteIRolne.shp,UWAGI,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\nieuzytkowe.shp,UWAGI,0,253;INFO_DODAT \"INFO_DODAT\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\niezabudowane.shp,INFO_DODAT,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\trawiasteIRolne.shp,INFO_DODAT,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\nieuzytkowe.shp,INFO_DODAT,0,253;KOD10K \"KOD10K\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\niezabudowane.shp,KOD10K,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\trawiasteIRolne.shp,KOD10K,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\nieuzytkowe.shp,KOD10K,0,253;SKROT_KART \"SKROT_KART\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\niezabudowane.shp,SKROT_KART,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\trawiasteIRolne.shp,SKROT_KART,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\nieuzytkowe.shp,SKROT_KART,0,253;RODZAJ \"RODZAJ\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\niezabudowane.shp,RODZAJ,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\trawiasteIRolne.shp,RODZAJ,0,253,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\nieuzytkowe.shp,RODZAJ,0,253;BDOT500 \"BDOT500\" true true false 254 Text 0 0,First,#,C:\\Users\\Wikaa\\Desktop\\Uczelnia-notatki\\5_semestr\\podstawy_programowania_aplikacji_gis\\projekt_zaliczeniowy_WH_AS\\dane\\daneBDOTPotrzebne\\nieuzytkowe.shp,BDOT500,0,253")

        # Dissolve - połączenie terenów odpoweidnich w jeden obiekt
        obszaryOdpowiednie_Diss = fr"{temp}\obszaryOdpowiednie_Diss"
        arcpy.management.Dissolve(in_features=obszaryOdpowiednie_merge_shp, out_feature_class=obszaryOdpowiednie_Diss)

        # Union - wypełnienie terenów pustych do granic powiatu
        obszaryOdpowiednie_Union_shp = fr"{temp}\obszaryOdpowiednie_Union.shp"
        arcpy.analysis.Union(in_features=[[obszaryOdpowiednie_Diss, ""], [powiat_sztumski_granica_shp, ""]], out_feature_class=obszaryOdpowiednie_Union_shp)

        # Polygon to Raster - zamiana warstwy wektorowej na rastrową
        obszaryOdpowiednie_raster_tif = fr"{temp}\obszaryOdpowiednie_raster.tif"
        arcpy.conversion.PolygonToRaster(in_features=obszaryOdpowiednie_Union_shp, value_field="FID_obszar", out_rasterdataset=obszaryOdpowiednie_raster_tif)

        # Reclassify - reklasyfikacja odpowiednich terenów
        obszaryOdpowiednie_reclass_tif = fr"{temp}\obszaryOdpowiednie_reclass.tif"
        Reclassify_9_ = obszaryOdpowiednie_reclass_tif
        obszaryOdpowiednie_reclass_tif = arcpy.sa.Reclassify(obszaryOdpowiednie_raster_tif, "VALUE", "-1 0;0 1", "DATA")
        obszaryOdpowiednie_reclass_tif.save(Reclassify_9_)

        # Buffer - utworzenie buforu do linii energetycznych
        linieEnergetyczne_buf_shp = fr"{temp}\linieEnergetyczne_buf.shp"
        arcpy.analysis.Buffer(in_features=PL_PZGiK_336_BDOT10k_2216_OT_SULN_L, out_feature_class=linieEnergetyczne_buf_shp, buffer_distance_or_field="190 Meters")

        # Clip - przycięcie lini do granic powiatu
        linieEnergetyczne_Clip_shp = fr"{temp}\linieEnergetyczne_Clip.shp"
        arcpy.analysis.Clip(in_features=linieEnergetyczne_buf_shp, clip_features=powiat_sztumski_granica_shp, out_feature_class=linieEnergetyczne_Clip_shp)

        # Dissolve - utworzenie jednego obiektu z lini
        linieEnergetyczne_diss_shp = fr"{temp}\linieEnergetyczne_diss.shp"
        arcpy.management.Dissolve(in_features=linieEnergetyczne_Clip_shp, out_feature_class=linieEnergetyczne_diss_shp)

        # Union wypełnienie pustej powierzchni do granic powiatu
        linieEnergetyczne_diss_union_shp = fr"{temp}\linieEnergetyczne_diss_union.shp"
        arcpy.analysis.Union(in_features=[[linieEnergetyczne_diss_shp, ""], [powiat_sztumski_granica_shp, ""]], out_feature_class=linieEnergetyczne_diss_union_shp)

        # Polygon to Raster - konwersja warstwy wektorowej na rastrową
        linieEnergetyczne_raster_tif = fr"{temp}\linieEnergetyczne_raster.tif"
        arcpy.conversion.PolygonToRaster(in_features=linieEnergetyczne_diss_union_shp, value_field="FID_linieE", out_rasterdataset=linieEnergetyczne_raster_tif)

        # Reclassify - reklasyfikacja lini energetycznych
        linieEnergetyczne_reclass_tif = fr"{temp}\linieEnergetyczne_reclass.tif"
        arcpy.ddd.Reclassify(in_raster=linieEnergetyczne_raster_tif, reclass_field="VALUE", remap="-1 1;0 0", out_raster=linieEnergetyczne_reclass_tif)
        linieEnergetyczne_reclass_tif = arcpy.Raster(linieEnergetyczne_reclass_tif)

        # Raster Calculator - przemnożenie rastrów przez siebie
        RasterWynikowy_tif_2_ = fr"{temp}\RasterWynikowy.tif"
        Raster_Calculator = RasterWynikowy_tif_2_
        RasterWynikowy_tif_2_ = zabudow_reclass_tif * aspect_reclass_tif * obszaryChronione_reclass_tif * wody_reclass_tif * obszaryOdpowiednie_reclass_tif * linieEnergetyczne_reclass_tif == 1
        RasterWynikowy_tif_2_.save(Raster_Calculator)


        # Raster to Polygon - konwersja warstwy rastrowej na wektorową
        PoligonWynikowyCaly_shp_2_ = fr"{temp}\PoligonWynikowyCaly.shp"
        with arcpy.EnvManager(outputMFlag="Disabled", outputZFlag="Disabled"):
            arcpy.conversion.RasterToPolygon(in_raster=RasterWynikowy_tif_2_, out_polygon_features=PoligonWynikowyCaly_shp_2_, simplify="NO_SIMPLIFY")

        # Add Field - dodanie pola w tabeli atrybutów
        PoligonWynikowyCaly_shp = arcpy.management.AddField(in_table=PoligonWynikowyCaly_shp_2_, field_name="area", field_type="DOUBLE")[0]

        # Calculate Geometry Attributes - obliczenie powierzchni poligonów wynikowych
        PoligonWynikowyCaly_shp_3_ = arcpy.management.CalculateGeometryAttributes(in_features=PoligonWynikowyCaly_shp, geometry_property=[["area", "AREA"]], area_unit="HECTARES")[0]

        # Select Layer By Attribute - wybór poligonów powyżej 2 ha
        PoligonWynikowyCaly_shp_4_, Count_2_ = arcpy.management.SelectLayerByAttribute(in_layer_or_view=PoligonWynikowyCaly_shp_3_, where_clause="area >= 2 And gridcode = 1")

        # Copy Features - kopiowanie wybranych poligonów
        TerenyWynikowe_shp = fr"{temp}\TerenyWynikowe.shp"
        arcpy.management.CopyFeatures(in_features=PoligonWynikowyCaly_shp_4_, out_feature_class=TerenyWynikowe_shp)

if __name__ == '__main__':
    Model()
